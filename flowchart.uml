@startuml
start

:import sys
import argparse
from datetime import datetime;

:parseの作成;

:引数、オプションの設定・追加;

:引数の解析;
partition try1{
:現在時刻の取得
ファイル読み込み(1行ずつ);

:書き込みモードで出力ファイルを開く;

while (log_line) is (yes)
 if (args.check in log_line.strip()) then (yes)
  if (args.search in log_line.strip()) then (yes)
   :fresult=0]
  else (no)
   :fresult=-1]
  endif
 else (no)
  partition try2{
   :時間差分取得(t_dif);
   if (t_dif.days < args.day) then (yes)
    :ftime=0]
   else (no)
    :ftime=-2]
   endif
  }
 if (except ValueError) then (yes)
  :pass;
 endif
 
 endif
 :ファイル読み込み(1行);
endwhile
if (fresult==0 and ftime==0) then (yes)
 :0 正常終了;
endif
if (fresult==-1 and ftime==0) then (yes)
 :-1 バックアップが取れていない;
endif
if (fresult==0 and ftime==-2) then (yes)
 :-2 更新日時が古い;
endif
if (fresult==-1 and ftime==-2) then (yes)
 :-3 バックアップ、更新日時ともにできてない;
endif
}
if (except Exception) then (yes)
 :-9 予期せぬエラー;
endif
:f.close;
end

@enduml
